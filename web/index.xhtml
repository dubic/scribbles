<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:d="http://xmlns.jcp.org/jsf/component"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Index test</title>
        <!-- BEGIN GLOBAL MANDATORY STYLES -->          
        <link href="/scribbles/assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
        <!-- END GLOBAL MANDATORY STYLES -->
        <!-- BEGIN PAGE LEVEL PLUGIN STYLES --> 

        <link href="/scribbles/assets/plugins/gritter/css/jquery.gritter.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css" />
        <link href="/scribbles/assets/plugins/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/plugins/jqvmap/jqvmap/jqvmap.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/plugins/jquery-easy-pie-chart/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css"/>
        <!-- END PAGE LEVEL PLUGIN STYLES -->
        <!-- BEGIN THEME STYLES --> 
        <link href="/scribbles/assets/css/style-metronic.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/style.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/style-responsive.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/plugins.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/pages/tasks.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/themes/default.css" rel="stylesheet" type="text/css" id="style_color"/>
        <link href="/scribbles/assets/css/custom.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/dubic.css" rel="stylesheet" type="text/css"/>
        <link href="/scribbles/assets/css/pages/login.css" rel="stylesheet" type="text/css"/>

        <!-- END THEME STYLES -->
        <link rel="shortcut icon" href="favicon.ico" />
        <link rel='stylesheet' type='text/css' href='/scribbles/test/post.css'/>
    </h:head>
    <h:body>
        <h:form id="form1" prependId="false">
            <h:commandButton value="response writer" action="#{moBean.testWriter}"></h:commandButton>
            <d:col value="dubic is great" style="background: #05B2D2"></d:col>

            <h:inputText id="valTxt" value="#{moBean.nullTest}" validator="#{moBean.validate}">

            </h:inputText>
            <h:message id="msg" for="valTxt" style="background: #DA8028"/>
            <ui:repeat value="#{moBean.persons}" var="person">
                <div><scan>#{person.name}</scan>
                    <h:commandButton value="response writer">
                        <f:ajax execute="@form" render="@form" listener="#{moBean.testWriter}"/>
                        <f:param name="id" value="#{person.id}"/>
                    </h:commandButton>
                </div>
            </ui:repeat>
            <d:script value="test" binding="#{moBean.script}"/>
        </h:form>


    </h:body>
    <!-- BEGIN CORE PLUGINS -->
    <script src="/scribbles/assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>   
    <!-- IMPORTANT! Load jquery-ui-1.10.3.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
    <script src="/scribbles/assets/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/bootstrap-hover-dropdown/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript" ></script>
    <script src="/scribbles/assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jquery.blockui.min.js" type="text/javascript"></script>  
    <script src="/scribbles/assets/plugins/jquery.cookie.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript" ></script>
    <!-- END CORE PLUGINS -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/jquery.vmap.js" type="text/javascript"></script>   
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/maps/jquery.vmap.russia.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/maps/jquery.vmap.world.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/maps/jquery.vmap.europe.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/maps/jquery.vmap.germany.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/maps/jquery.vmap.usa.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jqvmap/jqvmap/data/jquery.vmap.sampledata.js" type="text/javascript"></script>  
    <script src="/scribbles/assets/plugins/flot/jquery.flot.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/flot/jquery.flot.resize.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jquery.pulsate.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/bootstrap-daterangepicker/moment.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/bootstrap-daterangepicker/daterangepicker.js" type="text/javascript"></script>     
    <script src="/scribbles/assets/plugins/gritter/js/jquery.gritter.js" type="text/javascript"></script>
    <!-- IMPORTANT! fullcalendar depends on jquery-ui-1.10.3.custom.min.js for drag & drop support -->
    <script src="/scribbles/assets/plugins/fullcalendar/fullcalendar/fullcalendar.min.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jquery-easy-pie-chart/jquery.easy-pie-chart.js" type="text/javascript"></script>
    <script src="/scribbles/assets/plugins/jquery.sparkline.min.js" type="text/javascript"></script>  
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
    <script src="/scribbles/assets/scripts/app.js" type="text/javascript"></script>
    <script src="/scribbles/assets/scripts/index.js" type="text/javascript"></script>
    <script src="/scribbles/assets/scripts/tasks.js" type="text/javascript"></script>     
    <script src="/scribbles/test/jquery.dubic.effects.js" type="text/javascript"></script> 
    <script>
        $(".share-action").click(function(evt) {
            $(this).siblings(".dpopover").fadeIn(300);
            evt.preventDefault();
        });

        function test(post) {
//            alert("name - "+post.name);
            var postContainer = $('<section class="post-container"></section>')
                    .append($('<div class="row"></div>')
                            .append($('<div class="col-md-1"></div>')
                                    .append($('<img class="poster-img" width="60" height="60"/>').attr('src', '../assets/img/avatar1.jpg')))
                            .append($('<div  class="col-md-10"></div>')
                                    .append($('<div class="row"></div>').append($('<a class="person"></a>').attr('href', 'profile.jsp').text(post.name)))
                                    .append($('<div class="row"></div>').append($('<span class="date-grey"></span>').text('3 hrs ago')))
                                    .append($('<div class="row stats"></div>')
                                            .append($('<i class="icon-eye-open"></i>')).append($('<span></span>').text('23,675'))
                                            .append($('<i class="icon-thumbs-up"></i>')).append($('<span class="likes"></span>').text('4'))
                                            .append($('<i class="icon-thumbs-down"></i>')).append($('<span class="dislikes"></span>').text('2'))
                                            .append($('<i class="icon-comments"></i>')).append($('<span></span>').text('12'))
                                            )));
            postContainer.append($('<div class="row post"></div>').append($('<p></p>').text('Within the view, user events occur that')));
            //////////////ACTIONS BAR AND POP UPS//////////////////////
            var sharePop = $('<div class="dpopover"><div class="pop-head"><span>Share Options</span><i class="icon-remove" title="close"></i></div><div class="pop-body"><input class="form-text" type="text"/><button class="btn green small">show</button></div></div>');
            var shareLink = $('<a href="#">Share</a>').click(function(evt) {
                openShareOptions(evt, $(this));
            });
            var reportLink = $('<a href="#">Report</a>').click(function(evt) {
                openReportOptions(evt, $(this));
            });
            var likeLink = $('<a href="#">Like</a>').click(function(evt) {
                openReportOptions(evt, $(this));
            });
            var dislikeLink = $('<a href="#">Dislike</a>').click(function(evt) {
                openReportOptions(evt, $(this));
            });
            var commentLink = $('<a href="#">Comment</a>').click(function(evt) {
                showMyComment(evt, $(this));
            });
            var reportPop = $('<div class="dpopover"><div class="pop-head"><span>Report Post</span><i class="icon-remove" title="close"></i></div><div class="pop-body"><ul class="list-unstyled"><li></li></ul><button class="btn green small">show</button></div></div>');
            postContainer.append($('<div class="row action-bar"></div>')
                    .append($('<ul class="list-inline"></ul>')
                            .append($('<li></li>').append(likeLink))
                            .append($('<li></li>').append(dislikeLink))
                            .append($('<li></li>').append(commentLink))
                            .append($('<li></li>').append(shareLink).append(sharePop))
                            .append($('<li></li>').append(reportLink).append(reportPop))));
            /////////////////HIDE COMMENTS LINK//////////////////////////
            var hideCommLink = $('<span class="pull-right" style="position: relative"></span>').append($('<a href="#">show comments</a>').click(function(evt) {
                hideComments(evt, $(this));
            }));
            ////////////////////////////////////////
            var commentsBody = $('<div class="comments-body"></div>');
            var commentBlock = $('<div class="row comment"></div>')
                    .append($('<div class="col-md-1"></div>')
                            .append($('<img class="poster-img" width="40" height="40"/>').attr('src', '/scribbles/test/img/femi.jpg')))
                    .append($('<div class="col-md-10"></div>')
                            .append($('<div class="row"></div>')
                                    .append($('<a class="person"></a>').attr('href', 'profile.jsp').text('Chinwe Collette'))
                                    .append($('<span class="date-grey" style="margin:0px 10px"></span>').text('2 hrs 3 mins ago')))
                            .append($('<div class="row"></div>').append($('<p></p>').text('code optimization is still going on. Most of the pages'))));

            postContainer.append($('<div class="row comments"></div>').append(hideCommLink).append(commentsBody.append(commentBlock)));
            ///////////////MY COMMENT//////////////////////////////
            var postCommentBtn = $('<button class="btn blue">comment</button>').click(function() {
                postComment($(this), post.id);
            });
            var myComment = $('<div class="row my-comment" style="display:none"></div>')
                    .append($('<div class="row"><textarea style="width: 100%" placeholder="comment on this joke"></textarea></div>'))
                    .append($('<div class="pull-right"></div>')
                            .append(postCommentBtn)
                            .append($('<span class="ajax-loader"><img title="c_loader.gif" src="../assets/img/loading.gif"/></span>')));

            postContainer.append(myComment);
//            console.log(postContainer.html());
            $('body').append(postContainer);
//                        alert(postContainer.html());
        }


        function openShareOptions(evt, source) {
//            console.log(source.parent().find(".dpopover"));
            source.parent().find(".dpopover").fadeToggle(300);
            evt.preventDefault();
        }
        //////////////SHOW COMMENT TEXTAREA//////////////////////
        function showMyComment(evt, source) {
            source.closest(".post-container").find(".my-comment").slideDown(800).focus(true);
            evt.preventDefault();
        }
        function hideComments(evt, source) {
            source.closest(".post-container").find(".comments-body").slideToggle();
            if (source.hasClass("active")) {
                source.text("show comments");
                source.removeClass("active");
            } else {
                source.text("hide comments");
                source.addClass("active");
            }
            evt.preventDefault();
        }
        //////////////POST A COMMENT ACTION//////////////////////
        function postComment(source, postId) {
            var loader = source.closest('.my-comment').find('.ajax-loader');
            Deffects.transitionFade(source,loader,0);
            var comment = source.closest('.my-comment').find('textarea').val();
            alert("post id = " + postId + ", comment = " + comment);
            Deffects.transitionFade(loader,source,500);
            source.closest(".post-container").find(".comments-body").append(getCommentBlock(comment));
            
        }
        ///////////////////TEST FUNCTION//////////////////
        function getCommentBlock(text){
            var cblock = $('<div class="row comment"></div>')
                    .append($('<div class="col-md-1"></div>')
                            .append($('<img class="poster-img" width="40" height="40"/>').attr('src', '/scribbles/test/img/femi.jpg')))
                    .append($('<div class="col-md-10"></div>')
                            .append($('<div class="row"></div>')
                                    .append($('<a class="person"></a>').attr('href', 'profile.jsp').text('Chinwe Collette'))
                                    .append($('<span class="date-grey" style="margin:0px 10px"></span>').text('2 hrs 3 mins ago')))
                            .append($('<div class="row"></div>').append($('<p></p>').text(text))));
                    return cblock;
        }
        $(".dpopover .icon-remove").click(function(evt) {
            $(this).closest(".dpopover").fadeOut(300);
        });
    </script>
</html>

